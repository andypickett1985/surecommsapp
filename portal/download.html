<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Download SureCloudComms</title>
  <style>
    :root { --navy: #202A44; --electric: #4C00FF; --red: #CE0037; --cloud: #E5E1E6; --white: #FFFFFF; }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', -apple-system, sans-serif; background: linear-gradient(160deg, var(--navy) 0%, #151d30 100%); min-height: 100vh; color: var(--white); }
    .container { max-width: 720px; margin: 0 auto; padding: 60px 24px; }
    .logo { text-align: center; margin-bottom: 48px; }
    .logo svg { margin-bottom: 16px; }
    .logo h1 { font-size: 32px; font-weight: 700; letter-spacing: -0.5px; }
    .logo p { color: rgba(255,255,255,0.5); margin-top: 8px; font-size: 16px; }
    .download-card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 32px; margin-bottom: 24px; }
    .download-card h2 { font-size: 20px; margin-bottom: 8px; }
    .download-card p { color: rgba(255,255,255,0.6); font-size: 14px; margin-bottom: 20px; }
    .download-card .platform { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; color: rgba(255,255,255,0.5); font-size: 13px; }
    .dl-btn { display: inline-flex; align-items: center; gap: 10px; padding: 14px 32px; background: var(--electric); color: var(--white); border: none; border-radius: 10px; font-size: 16px; font-weight: 600; text-decoration: none; cursor: pointer; transition: all 0.2s; }
    .dl-btn:hover { background: #3b00cc; box-shadow: 0 4px 20px rgba(76,0,255,0.4); transform: translateY(-1px); }
    .dl-btn svg { flex-shrink: 0; }
    .files-list { margin-top: 16px; }
    .file-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: rgba(255,255,255,0.04); border-radius: 8px; margin-bottom: 8px; }
    .file-info { display: flex; align-items: center; gap: 12px; }
    .file-icon { width: 40px; height: 40px; border-radius: 8px; background: rgba(76,0,255,0.2); display: flex; align-items: center; justify-content: center; color: var(--electric); }
    .file-name { font-weight: 500; font-size: 14px; }
    .file-meta { font-size: 12px; color: rgba(255,255,255,0.4); margin-top: 2px; }
    .file-dl { padding: 8px 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; color: var(--white); text-decoration: none; font-size: 13px; font-weight: 500; transition: all 0.2s; }
    .file-dl:hover { background: var(--electric); border-color: var(--electric); }
    .empty { text-align: center; padding: 32px; color: rgba(255,255,255,0.3); }
    .features { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 32px; }
    .feature { background: rgba(255,255,255,0.04); border-radius: 12px; padding: 20px; }
    .feature h3 { font-size: 14px; margin-bottom: 4px; }
    .feature p { font-size: 13px; color: rgba(255,255,255,0.5); }
    .footer { text-align: center; margin-top: 48px; color: rgba(255,255,255,0.3); font-size: 13px; }
    @media (max-width: 600px) { .features { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <svg width="64" height="64" viewBox="0 0 48 48" fill="none">
        <rect width="48" height="48" rx="12" fill="rgba(255,255,255,0.1)"/>
        <path d="M14 18C14 16.9 14.9 16 16 16H20L23 20H16V32H32V25L36 28V32C36 33.1 35.1 34 34 34H14C12.9 34 12 33.1 12 32V20C12 18.9 12.9 18 14 18Z" fill="#4C00FF"/>
        <circle cx="30" cy="20" r="6" fill="#CE0037" opacity="0.9"/>
      </svg>
      <h1>SureCloudComms</h1>
      <p>Download the softphone for your platform</p>
    </div>

    <div class="download-card">
      <h2>SureCloudComms for Windows</h2>
      <p>VoIP softphone with HD voice, video calling, and central provisioning. Works with any SIP-based PBX.</p>
      <div class="platform">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801"/></svg>
        Windows 7 / 8 / 10 / 11
      </div>

      <div id="downloads-list" class="files-list">
        <div class="empty">Loading...</div>
      </div>
    </div>

    <div class="features">
      <div class="feature">
        <h3>Easy Setup</h3>
        <p>Sign in with your email and password - SIP configuration is automatic.</p>
      </div>
      <div class="feature">
        <h3>HD Audio & Video</h3>
        <p>Crystal clear calls with Opus, G.722 and modern video codecs.</p>
      </div>
      <div class="feature">
        <h3>Secure</h3>
        <p>TLS encryption for signalling and SRTP for media streams.</p>
      </div>
      <div class="feature">
        <h3>Lightweight</h3>
        <p>Small footprint, fast startup, minimal resource usage.</p>
      </div>
    </div>

    <div class="footer">
      <p>&copy; 2026 SureCloudComms. All rights reserved.</p>
    </div>
  </div>

  <script>
    async function loadDownloads() {
      try {
        const res = await fetch('/api/admin/downloads/public');
        const files = await res.json();
        const container = document.getElementById('downloads-list');

        if (!files || files.length === 0) {
          container.innerHTML = '<div class="empty"><p>No downloads available yet.</p><p style="margin-top:8px;font-size:12px">Contact your administrator.</p></div>';
          return;
        }

        container.innerHTML = files.map(f => {
          const sizeMB = (f.size / (1024 * 1024)).toFixed(1);
          const date = new Date(f.modified).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
          const ext = f.name.split('.').pop().toUpperCase();
          return `<div class="file-item">
            <div class="file-info">
              <div class="file-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m4-5l5 5 5-5m-5 5V3"/></svg>
              </div>
              <div>
                <div class="file-name">${f.name}</div>
                <div class="file-meta">${ext} &middot; ${sizeMB} MB &middot; ${date}</div>
              </div>
            </div>
            <a href="${f.url}" class="file-dl" download>Download</a>
          </div>`;
        }).join('');
      } catch (err) {
        document.getElementById('downloads-list').innerHTML = '<div class="empty">Failed to load downloads.</div>';
      }
    }
    loadDownloads();
  </script>
</body>
</html>
